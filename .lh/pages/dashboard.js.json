{
    "sourceFile": "pages/dashboard.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1755746544424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1755746719499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,9 +16,10 @@\n   const [user, loading] = useAuthState(auth);\n   const [userData, setUserData] = useState(null);\n   const [enrolledCourses, setEnrolledCourses] = useState([]);\n   const [createdCourses, setCreatedCourses] = useState([]);\n-  const [enrollments, setEnrollments] = useState([]); // ‚Üê Nueva: todas las inscripciones\n+  const [enrollments, setEnrollments] = useState([]); // todas las inscripciones\n+  const [grades, setGrades] = useState({}); // estado para mostrar calificaciones por curso\n   const [userLoaded, setUserLoaded] = useState(false);\n   const router = useRouter();\n \n   useEffect(() => {\n@@ -57,8 +58,9 @@\n                 return {\n                   id: courseDoc.id,\n                   ...courseData,\n                   progress: enrollmentData.progress || [],\n+                  grade: enrollmentData.grade || null, // ‚Üê cargar nota\n                 };\n               }\n               return null;\n             })\n@@ -68,33 +70,54 @@\n         }\n \n         // Cargar cursos del profesor\n         if (data.role === \"teacher\") {\n-          // Cargar TODAS las inscripciones para contar estudiantes\n-          const enrollmentsSnapshot = await getDocs(\n-            collection(db, \"enrollments\")\n-          );\n+          // Cargar TODAS las inscripciones\n+          const enrollmentsSnapshot = await getDocs(collection(db, \"enrollments\"));\n           const allEnrollments = enrollmentsSnapshot.docs.map((doc) => ({\n+            enrollmentId: doc.id,\n+            userId: doc.data().userId,\n             courseId: doc.data().courseId,\n+            grade: doc.data().grade || null,\n+            progress: doc.data().progress || [],\n           }));\n           setEnrollments(allEnrollments);\n \n+          // Cargar usuarios (para obtener nombres)\n+          const usersSnapshot = await getDocs(collection(db, \"users\"));\n+          const usersMap = {};\n+          usersSnapshot.docs.forEach((doc) => {\n+            usersMap[doc.id] = doc.data().name;\n+          });\n+\n           // Cargar cursos del profesor\n           const coursesRef = collection(db, \"courses\");\n           const q = query(coursesRef, where(\"teacherId\", \"==\", user.uid));\n           const querySnapshot = await getDocs(q);\n \n           const courses = querySnapshot.docs.map((doc) => {\n             const courseData = doc.data();\n-            // Contar estudiantes inscritos en este curso\n-            const studentCount = allEnrollments.filter(\n-              (e) => e.courseId === doc.id\n-            ).length;\n+            const courseId = doc.id;\n \n+            // Filtrar inscripciones de este curso\n+            const courseEnrollments = allEnrollments.filter(\n+              (e) => e.courseId === courseId\n+            );\n+\n+            // Contar estudiantes y obtener sus datos\n+            const students = courseEnrollments.map((e) => ({\n+              userId: e.userId,\n+              name: usersMap[e.userId] || \"Nombre no disponible\",\n+              grade: e.grade,\n+              progressCount: e.progress.length,\n+              totalLessons: courseData.lessons?.length || 0,\n+            }));\n+\n             return {\n-              id: doc.id,\n+              id: courseId,\n               ...courseData,\n-              studentCount, // ‚Üê A√±adido\n+              studentCount: students.length,\n+              students, // ‚Üê lista de estudiantes con notas\n             };\n           });\n \n           setCreatedCourses(courses);\n@@ -108,8 +131,16 @@\n \n     fetchUserData();\n   }, [user, loading, router]);\n \n+  // Alternar visibilidad de calificaciones\n+  const toggleGrades = (courseId) => {\n+    setGrades((prev) => ({\n+      ...prev,\n+      [courseId]: !prev[courseId],\n+    }));\n+  };\n+\n   if (loading || !userLoaded) {\n     return (\n       <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\n         <div className=\"text-center\">\n@@ -123,9 +154,9 @@\n   if (!user) return null;\n \n   return (\n     <div className=\"min-h-screen bg-gray-50\">\n-      {/* ‚úÖ Navbar com√∫n */}\n+      {/* ‚úÖ Navbar */}\n       <Navbar user={user} userData={userData} />\n \n       <main className=\"p-6 max-w-7xl mx-auto\">\n         <h2 className=\"text-2xl font-semibold text-gray-800 mb-6\">\n@@ -134,28 +165,29 @@\n \n         {/* Panel para Estudiantes */}\n         {userData?.role === \"student\" && (\n           <section className=\"bg-white p-6 rounded-lg shadow mb-8\">\n-            <h3 className=\"text-xl font-medium text-gray-800 mb-4\">\n-              Tus Cursos\n-            </h3>\n+            <h3 className=\"text-xl font-medium text-gray-800 mb-4\">Tus Cursos</h3>\n             {enrolledCourses.length > 0 ? (\n               <div className=\"grid gap-5 md:grid-cols-2 lg:grid-cols-3\">\n                 {enrolledCourses.map((course) => (\n                   <div\n                     key={course.id}\n                     className=\"border rounded-lg p-4 hover:shadow-md transition\"\n                   >\n-                    <h4 className=\"font-medium text-gray-800\">\n-                      {course.title}\n-                    </h4>\n+                    <h4 className=\"font-medium text-gray-800\">{course.title}</h4>\n                     <p className=\"text-sm text-gray-500 mt-1 line-clamp-2\">\n                       {course.description}\n                     </p>\n                     <p className=\"text-xs text-gray-500 mt-2\">\n-                      Progreso: {course.progress.length} /{\" \"}\n-                      {course.lessons?.length || 0}\n+                      Progreso: {course.progress.length} / {course.lessons?.length || 0}\n                     </p>\n+                    {/* Mostrar calificaci√≥n si existe */}\n+                    {course.grade !== null && (\n+                      <p className=\"text-sm text-green-600 font-medium mt-1\">\n+                        Nota: {course.grade}/100\n+                      </p>\n+                    )}\n                     <button\n                       onClick={() => router.push(`/courses/${course.id}`)}\n                       className=\"mt-3 w-full text-center text-sm bg-blue-600 hover:bg-blue-700 text-white py-1 rounded\"\n                     >\n@@ -164,11 +196,9 @@\n                   </div>\n                 ))}\n               </div>\n             ) : (\n-              <p className=\"text-gray-500\">\n-                No est√°s inscrito en ning√∫n curso.\n-              </p>\n+              <p className=\"text-gray-500\">No est√°s inscrito en ning√∫n curso.</p>\n             )}\n           </section>\n         )}\n \n@@ -188,22 +218,50 @@\n               <div className=\"grid gap-5 md:grid-cols-2 lg:grid-cols-3\">\n                 {createdCourses.map((course) => (\n                   <div\n                     key={course.id}\n-                    className=\"border rounded-lg p-4 hover:shadow-md transition cursor-pointer\"\n-                    onClick={() => router.push(`/teacher/course/${course.id}`)}\n+                    className=\"border rounded-lg p-4 hover:shadow-md transition\"\n                   >\n-                    <h4 className=\"font-medium text-gray-800\">\n+                    <h4\n+                      className=\"font-medium text-gray-800 cursor-pointer hover:text-indigo-600\"\n+                      onClick={() => router.push(`/teacher/course/${course.id}`)}\n+                    >\n                       {course.title}\n                     </h4>\n                     <p className=\"text-sm text-gray-500 mt-1\">\n                       {course.lessons?.length || 0} lecciones\n                     </p>\n-                    {/* ‚úÖ Mostrar n√∫mero de estudiantes */}\n-                    <p className=\"text-sm text-blue-600 font-medium mt-2\">\n-                      {course.studentCount}{\" \"}\n-                      {course.studentCount === 1 ? \"estudiante\" : \"estudiantes\"}\n+                    <p className=\"text-sm text-blue-600 font-medium mt-1\">\n+                      {course.studentCount} {course.studentCount === 1 ? \"estudiante\" : \"estudiantes\"}\n                     </p>\n+\n+                    {/* Bot√≥n para ver calificaciones */}\n+                    <button\n+                      onClick={() => toggleGrades(course.id)}\n+                      className=\"text-xs mt-2 text-indigo-600 hover:underline\"\n+                    >\n+                      {grades[course.id] ? \"Ocultar\" : \"Ver\"} calificaciones\n+                    </button>\n+\n+                    {/* Lista de estudiantes y calificaciones */}\n+                    {grades[course.id] && (\n+                      <div className=\"mt-3 border-t pt-2 max-h-60 overflow-y-auto text-xs\">\n+                        {course.students.length > 0 ? (\n+                          <ul className=\"space-y-1\">\n+                            {course.students.map((student) => (\n+                              <li key={student.userId} className=\"flex justify-between\">\n+                                <span>{student.name}</span>\n+                                <span className=\"font-medium\">\n+                                  {student.grade !== null ? `${student.grade}/100` : \"Sin nota\"}\n+                                </span>\n+                              </li>\n+                            ))}\n+                          </ul>\n+                        ) : (\n+                          <p className=\"text-gray-500\">Sin estudiantes</p>\n+                        )}\n+                      </div>\n+                    )}\n                   </div>\n                 ))}\n               </div>\n             ) : (\n@@ -214,19 +272,12 @@\n \n         {/* Informaci√≥n del usuario */}\n         <div className=\"bg-white p-5 rounded-lg shadow\">\n           <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Tu Perfil</h3>\n-          <p>\n-            <strong>Nombre:</strong> {userData?.name}\n-          </p>\n-          <p>\n-            <strong>Email:</strong> {user.email}\n-          </p>\n-          <p>\n-            <strong>Rol:</strong>{\" \"}\n-            {userData?.role === \"teacher\" ? \"Profesor\" : \"Estudiante\"}\n-          </p>\n+          <p><strong>Nombre:</strong> {userData?.name}</p>\n+          <p><strong>Email:</strong> {user.email}</p>\n+          <p><strong>Rol:</strong> {userData?.role === \"teacher\" ? \"Profesor\" : \"Estudiante\"}</p>\n         </div>\n       </main>\n     </div>\n   );\n-}\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1755746936338,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,11 +15,12 @@\n export default function Dashboard() {\n   const [user, loading] = useAuthState(auth);\n   const [userData, setUserData] = useState(null);\n   const [enrolledCourses, setEnrolledCourses] = useState([]);\n-  const [createdCourses, setCreatedCourses] = useState([]);\n-  const [enrollments, setEnrollments] = useState([]); // todas las inscripciones\n-  const [grades, setGrades] = useState({}); // estado para mostrar calificaciones por curso\n+  const [createdCourses, setCreatedCourses, ] = useState([]);\n+  const [enrollments, setEnrollments] = useState([]);\n+  const [reviews, setReviews] = useState([]); // ‚Üê Nueva: cargar rese√±as\n+  const [grades, setGrades] = useState({});\n   const [userLoaded, setUserLoaded] = useState(false);\n   const router = useRouter();\n \n   useEffect(() => {\n@@ -54,13 +55,27 @@\n               const courseDoc = await getDoc(doc(db, \"courses\", courseId));\n               if (courseDoc.exists()) {\n                 const courseData = courseDoc.data();\n                 const enrollmentData = enrollmentDoc.data();\n+\n+                // Cargar calificaci√≥n del curso\n+                let courseRating = null;\n+                const reviewsRef = collection(db, \"reviews\");\n+                const r = query(\n+                  reviewsRef,\n+                  where(\"courseId\", \"==\", courseId),\n+                  where(\"userId\", \"==\", user.uid)\n+                );\n+                const reviewSnap = await getDocs(r);\n+                if (!reviewSnap.empty) {\n+                  courseRating = reviewSnap.docs[0].data().rating;\n+                }\n+\n                 return {\n                   id: courseDoc.id,\n                   ...courseData,\n                   progress: enrollmentData.progress || [],\n-                  grade: enrollmentData.grade || null, // ‚Üê cargar nota\n+                  grade: courseRating, // ‚Üê nota del curso\n                 };\n               }\n               return null;\n             })\n@@ -71,21 +86,30 @@\n \n         // Cargar cursos del profesor\n         if (data.role === \"teacher\") {\n           // Cargar TODAS las inscripciones\n-          const enrollmentsSnapshot = await getDocs(\n-            collection(db, \"enrollments\")\n-          );\n+          const enrollmentsSnapshot = await getDocs(collection(db, \"enrollments\"));\n           const allEnrollments = enrollmentsSnapshot.docs.map((doc) => ({\n             enrollmentId: doc.id,\n             userId: doc.data().userId,\n             courseId: doc.data().courseId,\n-            grade: doc.data().grade || null,\n             progress: doc.data().progress || [],\n           }));\n           setEnrollments(allEnrollments);\n \n-          // Cargar usuarios (para obtener nombres)\n+          // Cargar TODAS las rese√±as\n+          const reviewsSnapshot = await getDocs(collection(db, \"reviews\"));\n+          const allReviews = reviewsSnapshot.docs.map((doc) => ({\n+            courseId: doc.data().courseId,\n+            userId: doc.data().userId,\n+            rating: doc.data().rating,\n+            comment: doc.data().comment,\n+            userName: doc.data().userName,\n+            timestamp: doc.data().timestamp,\n+          }));\n+          setReviews(allReviews);\n+\n+          // Cargar usuarios (para nombres)\n           const usersSnapshot = await getDocs(collection(db, \"users\"));\n           const usersMap = {};\n           usersSnapshot.docs.forEach((doc) => {\n             usersMap[doc.id] = doc.data().name;\n@@ -99,27 +123,38 @@\n           const courses = querySnapshot.docs.map((doc) => {\n             const courseData = doc.data();\n             const courseId = doc.id;\n \n-            // Filtrar inscripciones de este curso\n+            // Estudiantes inscritos\n             const courseEnrollments = allEnrollments.filter(\n               (e) => e.courseId === courseId\n             );\n-\n-            // Contar estudiantes y obtener sus datos\n             const students = courseEnrollments.map((e) => ({\n               userId: e.userId,\n               name: usersMap[e.userId] || \"Nombre no disponible\",\n-              grade: e.grade,\n               progressCount: e.progress.length,\n               totalLessons: courseData.lessons?.length || 0,\n             }));\n \n+            // Calificaciones del curso\n+            const courseReviews = allReviews.filter(\n+              (r) => r.courseId === courseId\n+            );\n+            const averageRating =\n+              courseReviews.length > 0\n+                ? (\n+                    courseReviews.reduce((sum, r) => sum + r.rating, 0) /\n+                    courseReviews.length\n+                  ).toFixed(1)\n+                : \"Sin calificaciones\";\n+\n             return {\n               id: courseId,\n               ...courseData,\n               studentCount: students.length,\n-              students, // ‚Üê lista de estudiantes con notas\n+              students,\n+              averageRating, // ‚Üê Promedio\n+              reviews: courseReviews, // ‚Üê Rese√±as completas\n             };\n           });\n \n           setCreatedCourses(courses);\n@@ -133,9 +168,8 @@\n \n     fetchUserData();\n   }, [user, loading, router]);\n \n-  // Alternar visibilidad de calificaciones\n   const toggleGrades = (courseId) => {\n     setGrades((prev) => ({\n       ...prev,\n       [courseId]: !prev[courseId],\n@@ -156,43 +190,36 @@\n   if (!user) return null;\n \n   return (\n     <div className=\"min-h-screen bg-gray-50\">\n-      {/* ‚úÖ Navbar */}\n       <Navbar user={user} userData={userData} />\n \n       <main className=\"p-6 max-w-7xl mx-auto\">\n         <h2 className=\"text-2xl font-semibold text-gray-800 mb-6\">\n           Bienvenido, {userData?.name?.split(\" \")[0]} üëã\n         </h2>\n \n-        {/* Panel para Estudiantes */}\n+        {/* Panel Estudiantes */}\n         {userData?.role === \"student\" && (\n           <section className=\"bg-white p-6 rounded-lg shadow mb-8\">\n-            <h3 className=\"text-xl font-medium text-gray-800 mb-4\">\n-              Tus Cursos\n-            </h3>\n+            <h3 className=\"text-xl font-medium text-gray-800 mb-4\">Tus Cursos</h3>\n             {enrolledCourses.length > 0 ? (\n               <div className=\"grid gap-5 md:grid-cols-2 lg:grid-cols-3\">\n                 {enrolledCourses.map((course) => (\n                   <div\n                     key={course.id}\n                     className=\"border rounded-lg p-4 hover:shadow-md transition\"\n                   >\n-                    <h4 className=\"font-medium text-gray-800\">\n-                      {course.title}\n-                    </h4>\n+                    <h4 className=\"font-medium text-gray-800\">{course.title}</h4>\n                     <p className=\"text-sm text-gray-500 mt-1 line-clamp-2\">\n                       {course.description}\n                     </p>\n                     <p className=\"text-xs text-gray-500 mt-2\">\n-                      Progreso: {course.progress.length} /{\" \"}\n-                      {course.lessons?.length || 0}\n+                      Progreso: {course.progress.length} / {course.lessons?.length || 0}\n                     </p>\n-                    {/* Mostrar calificaci√≥n si existe */}\n                     {course.grade !== null && (\n-                      <p className=\"text-sm text-green-600 font-medium mt-1\">\n-                        Nota: {course.grade}/100\n+                      <p className=\"text-sm text-yellow-600 font-medium mt-1\">\n+                        ‚≠ê {course.grade}/5\n                       </p>\n                     )}\n                     <button\n                       onClick={() => router.push(`/courses/${course.id}`)}\n@@ -203,16 +230,14 @@\n                   </div>\n                 ))}\n               </div>\n             ) : (\n-              <p className=\"text-gray-500\">\n-                No est√°s inscrito en ning√∫n curso.\n-              </p>\n+              <p className=\"text-gray-500\">No est√°s inscrito en ning√∫n curso.</p>\n             )}\n           </section>\n         )}\n \n-        {/* Panel para Profesores */}\n+        {/* Panel Profesores */}\n         {userData?.role === \"teacher\" && (\n           <section className=\"bg-white p-6 rounded-lg shadow mb-8\">\n             <div className=\"flex justify-between items-center mb-4\">\n               <h3 className=\"text-xl font-medium text-gray-800\">Tus Cursos</h3>\n@@ -231,51 +256,50 @@\n                     className=\"border rounded-lg p-4 hover:shadow-md transition\"\n                   >\n                     <h4\n                       className=\"font-medium text-gray-800 cursor-pointer hover:text-indigo-600\"\n-                      onClick={() =>\n-                        router.push(`/teacher/course/${course.id}`)\n-                      }\n+                      onClick={() => router.push(`/teacher/course/${course.id}`)}\n                     >\n                       {course.title}\n                     </h4>\n                     <p className=\"text-sm text-gray-500 mt-1\">\n                       {course.lessons?.length || 0} lecciones\n                     </p>\n                     <p className=\"text-sm text-blue-600 font-medium mt-1\">\n-                      {course.studentCount}{\" \"}\n-                      {course.studentCount === 1 ? \"estudiante\" : \"estudiantes\"}\n+                      {course.studentCount} {course.studentCount === 1 ? \"estudiante\" : \"estudiantes\"}\n                     </p>\n+                    <p className=\"text-sm text-yellow-600 font-medium\">\n+                      ‚≠ê {course.averageRating}\n+                    </p>\n \n-                    {/* Bot√≥n para ver calificaciones */}\n                     <button\n                       onClick={() => toggleGrades(course.id)}\n                       className=\"text-xs mt-2 text-indigo-600 hover:underline\"\n                     >\n                       {grades[course.id] ? \"Ocultar\" : \"Ver\"} calificaciones\n                     </button>\n \n-                    {/* Lista de estudiantes y calificaciones */}\n                     {grades[course.id] && (\n                       <div className=\"mt-3 border-t pt-2 max-h-60 overflow-y-auto text-xs\">\n-                        {course.students.length > 0 ? (\n-                          <ul className=\"space-y-1\">\n-                            {course.students.map((student) => (\n-                              <li\n-                                key={student.userId}\n-                                className=\"flex justify-between\"\n-                              >\n-                                <span>{student.name}</span>\n-                                <span className=\"font-medium\">\n-                                  {student.grade !== null\n-                                    ? `${student.grade}/100`\n-                                    : \"Sin nota\"}\n-                                </span>\n+                        {course.reviews.length > 0 ? (\n+                          <ul className=\"space-y-2\">\n+                            {course.reviews.map((review, idx) => (\n+                              <li key={idx} className=\"pt-1 border-t\">\n+                                <strong>{review.userName}</strong>\n+                                <div className=\"flex\">\n+                                  {\"‚≠ê\".repeat(review.rating)}\n+                                  {\"‚òÜ\".repeat(5 - review.rating)}\n+                                </div>\n+                                {review.comment && (\n+                                  <p className=\"text-gray-600 italic mt-1\">\n+                                    \"{review.comment.substring(0, 80)}...\"\n+                                  </p>\n+                                )}\n                               </li>\n                             ))}\n                           </ul>\n                         ) : (\n-                          <p className=\"text-gray-500\">Sin estudiantes</p>\n+                          <p className=\"text-gray-500\">Sin rese√±as a√∫n</p>\n                         )}\n                       </div>\n                     )}\n                   </div>\n@@ -286,22 +310,15 @@\n             )}\n           </section>\n         )}\n \n-        {/* Informaci√≥n del usuario */}\n+        {/* Perfil */}\n         <div className=\"bg-white p-5 rounded-lg shadow\">\n           <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Tu Perfil</h3>\n-          <p>\n-            <strong>Nombre:</strong> {userData?.name}\n-          </p>\n-          <p>\n-            <strong>Email:</strong> {user.email}\n-          </p>\n-          <p>\n-            <strong>Rol:</strong>{\" \"}\n-            {userData?.role === \"teacher\" ? \"Profesor\" : \"Estudiante\"}\n-          </p>\n+          <p><strong>Nombre:</strong> {userData?.name}</p>\n+          <p><strong>Email:</strong> {user.email}</p>\n+          <p><strong>Rol:</strong> {userData?.role === \"teacher\" ? \"Profesor\" : \"Estudiante\"}</p>\n         </div>\n       </main>\n     </div>\n   );\n-}\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1755746544424,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { auth, db } from \"../lib/firebase\";\nimport {\n  doc,\n  getDoc,\n  collection,\n  getDocs,\n  query,\n  where,\n} from \"firebase/firestore\";\nimport Navbar from \"../components/Navbar\";\n\nexport default function Dashboard() {\n  const [user, loading] = useAuthState(auth);\n  const [userData, setUserData] = useState(null);\n  const [enrolledCourses, setEnrolledCourses] = useState([]);\n  const [createdCourses, setCreatedCourses] = useState([]);\n  const [enrollments, setEnrollments] = useState([]); // ‚Üê Nueva: todas las inscripciones\n  const [userLoaded, setUserLoaded] = useState(false);\n  const router = useRouter();\n\n  useEffect(() => {\n    if (loading) return;\n    if (!user) {\n      router.push(\"/login\");\n      return;\n    }\n\n    const fetchUserData = async () => {\n      try {\n        const userDocRef = doc(db, \"users\", user.uid);\n        const userDocSnap = await getDoc(userDocRef);\n\n        if (!userDocSnap.exists()) {\n          router.push(\"/register\");\n          return;\n        }\n\n        const data = userDocSnap.data();\n        setUserData(data);\n\n        // Cargar cursos del estudiante\n        if (data.role === \"student\") {\n          const enrollmentsRef = collection(db, \"enrollments\");\n          const q = query(enrollmentsRef, where(\"userId\", \"==\", user.uid));\n          const querySnapshot = await getDocs(q);\n\n          const courses = await Promise.all(\n            querySnapshot.docs.map(async (enrollmentDoc) => {\n              const courseId = enrollmentDoc.data().courseId;\n              const courseDoc = await getDoc(doc(db, \"courses\", courseId));\n              if (courseDoc.exists()) {\n                const courseData = courseDoc.data();\n                const enrollmentData = enrollmentDoc.data();\n                return {\n                  id: courseDoc.id,\n                  ...courseData,\n                  progress: enrollmentData.progress || [],\n                };\n              }\n              return null;\n            })\n          );\n\n          setEnrolledCourses(courses.filter(Boolean));\n        }\n\n        // Cargar cursos del profesor\n        if (data.role === \"teacher\") {\n          // Cargar TODAS las inscripciones para contar estudiantes\n          const enrollmentsSnapshot = await getDocs(collection(db, \"enrollments\"));\n          const allEnrollments = enrollmentsSnapshot.docs.map((doc) => ({\n            courseId: doc.data().courseId,\n          }));\n          setEnrollments(allEnrollments);\n\n          // Cargar cursos del profesor\n          const coursesRef = collection(db, \"courses\");\n          const q = query(coursesRef, where(\"teacherId\", \"==\", user.uid));\n          const querySnapshot = await getDocs(q);\n\n          const courses = querySnapshot.docs.map((doc) => {\n            const courseData = doc.data();\n            // Contar estudiantes inscritos en este curso\n            const studentCount = allEnrollments.filter(\n              (e) => e.courseId === doc.id\n            ).length;\n\n            return {\n              id: doc.id,\n              ...courseData,\n              studentCount, // ‚Üê A√±adido\n            };\n          });\n\n          setCreatedCourses(courses);\n        }\n      } catch (err) {\n        console.error(\"Error al cargar el dashboard:\", err);\n      } finally {\n        setUserLoaded(true);\n      }\n    };\n\n    fetchUserData();\n  }, [user, loading, router]);\n\n  if (loading || !userLoaded) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mb-3\"></div>\n          <p className=\"text-gray-600\">Cargando...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) return null;\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* ‚úÖ Navbar com√∫n */}\n      <Navbar user={user} userData={userData} />\n\n      <main className=\"p-6 max-w-7xl mx-auto\">\n        <h2 className=\"text-2xl font-semibold text-gray-800 mb-6\">\n          Bienvenido, {userData?.name?.split(\" \")[0]} üëã\n        </h2>\n\n        {/* Panel para Estudiantes */}\n        {userData?.role === \"student\" && (\n          <section className=\"bg-white p-6 rounded-lg shadow mb-8\">\n            <h3 className=\"text-xl font-medium text-gray-800 mb-4\">\n              Tus Cursos\n            </h3>\n            {enrolledCourses.length > 0 ? (\n              <div className=\"grid gap-5 md:grid-cols-2 lg:grid-cols-3\">\n                {enrolledCourses.map((course) => (\n                  <div\n                    key={course.id}\n                    className=\"border rounded-lg p-4 hover:shadow-md transition\"\n                  >\n                    <h4 className=\"font-medium text-gray-800\">\n                      {course.title}\n                    </h4>\n                    <p className=\"text-sm text-gray-500 mt-1 line-clamp-2\">\n                      {course.description}\n                    </p>\n                    <p className=\"text-xs text-gray-500 mt-2\">\n                      Progreso: {course.progress.length} /{\" \"}\n                      {course.lessons?.length || 0}\n                    </p>\n                    <button\n                      onClick={() => router.push(`/courses/${course.id}`)}\n                      className=\"mt-3 w-full text-center text-sm bg-blue-600 hover:bg-blue-700 text-white py-1 rounded\"\n                    >\n                      Entrar al Curso\n                    </button>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-gray-500\">\n                No est√°s inscrito en ning√∫n curso.\n              </p>\n            )}\n          </section>\n        )}\n\n        {/* Panel para Profesores */}\n        {userData?.role === \"teacher\" && (\n          <section className=\"bg-white p-6 rounded-lg shadow mb-8\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-xl font-medium text-gray-800\">Tus Cursos</h3>\n              <button\n                onClick={() => router.push(\"/teacher/create-course\")}\n                className=\"bg-indigo-600 hover:bg-indigo-700 text-white text-sm px-4 py-2 rounded\"\n              >\n                + Nuevo Curso\n              </button>\n            </div>\n            {createdCourses.length > 0 ? (\n              <div className=\"grid gap-5 md:grid-cols-2 lg:grid-cols-3\">\n                {createdCourses.map((course) => (\n                  <div\n                    key={course.id}\n                    className=\"border rounded-lg p-4 hover:shadow-md transition cursor-pointer\"\n                    onClick={() => router.push(`/teacher/course/${course.id}`)}\n                  >\n                    <h4 className=\"font-medium text-gray-800\">\n                      {course.title}\n                    </h4>\n                    <p className=\"text-sm text-gray-500 mt-1\">\n                      {course.lessons?.length || 0} lecciones\n                    </p>\n                    {/* ‚úÖ Mostrar n√∫mero de estudiantes */}\n                    <p className=\"text-sm text-blue-600 font-medium mt-2\">\n                      {course.studentCount} {course.studentCount === 1 ? \"estudiante\" : \"estudiantes\"}\n                    </p>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-gray-500\">No has creado ning√∫n curso.</p>\n            )}\n          </section>\n        )}\n\n        {/* Informaci√≥n del usuario */}\n        <div className=\"bg-white p-5 rounded-lg shadow\">\n          <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Tu Perfil</h3>\n          <p>\n            <strong>Nombre:</strong> {userData?.name}\n          </p>\n          <p>\n            <strong>Email:</strong> {user.email}\n          </p>\n          <p>\n            <strong>Rol:</strong>{\" \"}\n            {userData?.role === \"teacher\" ? \"Profesor\" : \"Estudiante\"}\n          </p>\n        </div>\n      </main>\n    </div>\n  );\n}"
        }
    ]
}