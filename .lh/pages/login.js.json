{
    "sourceFile": "pages/login.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1755745393913,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1755745401651,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n   };\n \n   return (\n     <mai className=\"grid grid-cols-2\">\n-      <div className=\"bg-[url('/img/banner.jpg')] bg-contain \"></div>\n+      <div className=\"bg-[url('/img/banner.jpg')] bg-cover \"></div>\n \n       <div className=\"min-h-screen flex items-center justify-center bg-[#673b76]/40 px-4\">\n         <div className=\"bg-white p-8 rounded-xl shadow-lg w-full max-w-md\">\n           <h1 className=\"text-3xl font-bold text-center text-gray-800 mb-6\">\n"
                },
                {
                    "date": 1755745493846,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n   };\n \n   return (\n     <mai className=\"grid grid-cols-2\">\n-      <div className=\"bg-[url('/img/banner.jpg')] bg-cover \"></div>\n+      <div className=\"bg-[url('/img/banner.jpg')] bg-contain \"></div>\n \n       <div className=\"min-h-screen flex items-center justify-center bg-[#673b76]/40 px-4\">\n         <div className=\"bg-white p-8 rounded-xl shadow-lg w-full max-w-md\">\n           <h1 className=\"text-3xl font-bold text-center text-gray-800 mb-6\">\n"
                }
            ],
            "date": 1755745393913,
            "name": "Commit-0",
            "content": "import { useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { getAuth, signInWithEmailAndPassword } from \"firebase/auth\";\nimport { doc, getDoc } from \"firebase/firestore\";\nimport { auth, db } from \"../lib/firebase\";\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const router = useRouter();\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    setError(\"\");\n    setLoading(true);\n\n    try {\n      // 1. Iniciar sesión\n      const userCredential = await signInWithEmailAndPassword(\n        auth,\n        email,\n        password\n      );\n      const user = userCredential.user;\n\n      // 2. Obtener el rol desde Firestore\n      const userDocRef = doc(db, \"users\", user.uid);\n      const userDocSnap = await getDoc(userDocRef);\n\n      if (!userDocSnap.exists()) {\n        setError(\n          \"No se encontraron datos del usuario. Contacta al administrador.\"\n        );\n        setLoading(false);\n        return;\n      }\n\n      const userData = userDocSnap.data();\n      const userRole = userData.role;\n\n      // 3. Redirigir según rol\n      if (userRole === \"admin\") {\n        router.push(\"/admin/dashboard\");\n      } else {\n        router.push(\"/dashboard\");\n      }\n    } catch (err) {\n      switch (err.code) {\n        case \"auth/invalid-email\":\n          setError(\"El correo no es válido.\");\n          break;\n        case \"auth/user-not-found\":\n        case \"auth/wrong-password\":\n          setError(\"Correo o contraseña incorrectos.\");\n          break;\n        default:\n          setError(\"Error: \" + err.message);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <mai className=\"grid grid-cols-2\">\n      <div className=\"bg-[url('/img/banner.jpg')] bg-cover \"></div>\n\n      <div className=\"min-h-screen flex items-center justify-center bg-[#673b76]/40 px-4\">\n        <div className=\"bg-white p-8 rounded-xl shadow-lg w-full max-w-md\">\n          <h1 className=\"text-3xl font-bold text-center text-gray-800 mb-6\">\n            Iniciar Sesión\n          </h1>\n\n          {error && (\n            <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded text-sm text-center\">\n              {error}\n            </div>\n          )}\n\n          <form onSubmit={handleLogin} className=\"space-y-5\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Correo Electrónico\n              </label>\n              <input\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-atenea focus:outline-none\"\n                placeholder=\"tu@correo.com\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Contraseña\n              </label>\n              <input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                minLength={6}\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-atenea focus:outline-none\"\n                placeholder=\"••••••\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full py-2 px-4 bg-atenea hover:bg-atenea disabled:bg-atenea text-white font-medium rounded-lg transition flex items-center justify-center gap-2\"\n            >\n              {loading ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\n                  Iniciando sesión...\n                </>\n              ) : (\n                \"Ingresar\"\n              )}\n            </button>\n          </form>\n\n          <p className=\"mt-6 text-center text-sm text-gray-600\">\n            ¿No tienes cuenta?{\" \"}\n            <a\n              href=\"/register\"\n              className=\"text-atenea hover:underline font-medium\"\n            >\n              Regístrate aquí\n            </a>\n          </p>\n        </div>\n      </div>\n    </mai>\n  );\n}\n"
        }
    ]
}